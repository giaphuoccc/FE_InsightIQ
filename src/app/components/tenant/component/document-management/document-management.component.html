<div class="container">
  <nav class="nav">
    <a class="active" href="#">Manage Document</a>
  </nav>

  <main class="main-content">
    <h2>List of documents</h2>

    <div
      *ngIf="deleteMessage"
      [ngClass]="{ 'alert-success': !deleteError, 'alert-danger': deleteError }"
      class="alert-message"
    >
      {{ deleteMessage }}
    </div>

    <section class="document-list">
      <h4>Uploaded documents</h4>
      <div *ngIf="isLoadingDocuments" class="loading-message">
        Đang tải danh sách tài liệu...
      </div>
      <table *ngIf="!isLoadingDocuments">
        <thead>
          <tr>
            <th>Document name</th>
            <th>Date modified</th>
            <th>Size</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="!isLoadingDocuments && documents.length === 0">
            <td colspan="4" class="empty-message">
              Chưa có tài liệu nào được tải lên.
            </td>
          </tr>
          <tr *ngFor="let doc of documents; let i = index">
            <td>
              <a
                *ngIf="doc?.fileUrl"
                [href]="doc.fileUrl"
                target="_blank"
                title="Xem file"
                >{{ doc.name }}</a
              >
              <span *ngIf="!doc?.fileUrl">{{ doc.name }}</span>
            </td>
            <td>{{ doc.modified }}</td>
            <td>{{ doc.size }}</td>
            <td>
              <button
                class="delete-btn"
                (click)="onDelete(i)"
                title="Xóa file này"
              >
                Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="upload-section">
      <h4>Add documents</h4>

      <div class="form-group">
        <label for="tenantIdInput">Tenant ID:</label>
        <input
          type="number"
          id="tenantIdInput"
          [(ngModel)]="tenantId"
          placeholder="Nhập ID của tenant"
          required
        />
      </div>

      <div class="form-group date-group">
        <label for="validFromInput">Valid From:</label>
        <input
          type="date"
          id="validFromInput"
          [(ngModel)]="validFrom"
          required
        />
      </div>

      <div class="form-group date-group">
        <label for="validUntilInput">Valid Until:</label>
        <input
          type="date"
          id="validUntilInput"
          [(ngModel)]="validUntil"
          required
        />
      </div>
      <div class="upload-box">
        <label for="fileInput" class="upload-label">
          <img src="assets/upload-icon.png" alt="Upload Icon" />
          <p>
            {{ fileToUpload ? fileToUpload.name : "Chọn file PDF để tải lên" }}
          </p>
        </label>
        <input
          type="file"
          id="fileInput"
          (change)="onFileSelected($event)"
          accept=".pdf,.txt"
          hidden
          #fileInputRef
        />
      </div>

      <div
        *ngIf="uploadMessage"
        [ngClass]="{
          'alert-success': !uploadError,
          'alert-danger': uploadError
        }"
        class="alert-message"
      >
        {{ uploadMessage }}
      </div>

      <button
        class="upload-button"
        (click)="onUpload()"
        [disabled]="
          isUploading ||
          !fileToUpload ||
          tenantId === null ||
          tenantId === undefined ||
          tenantId <= 0 ||
          !validFrom ||
          !validUntil
        "
      >
        {{ isUploading ? "Đang tải lên..." : "Upload Document" }}
      </button>
    </section>
  </main>
</div>
